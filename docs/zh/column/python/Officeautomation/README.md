---
blog: false
home: true
icon: home
title: Python 办公自动化
heroImage: /ColumnImages/Officeautomation/lena2.jpg
heroText: Python 办公自动化
heroFullScreen: true
tagline: 批量处理，解放重复劳作！
action:
  - text: 开始学习 💡
    link: /zh/column/python/Officeautomation/

  - text: 与作者联系 👋
    link: http://wpa.qq.com/msgrd?v=3&uin=1432803776&site=qq&menu=yes

footer: 立志降低教育成本，普及编程教育，提供优质资源教程——流沙团队宣
---

您好，我是悦创，很高兴能和您一起学习 Python 办公自动化。


恭喜你在搞定 Python 基础内容之后，来到办公自动化的课程，请确保你对 Python 的数据结构、条件、循环、函数等这些基础知识已经掌握得不错，本课程中对于基本的 Python 语法不会做过多的讲解。


请记得跟流沙团队说一声，让我们把你加到微信群中，方便为你提供其他服务哦。
# 1. 课程概述

所谓**办公自动化**，是将计算机技术使用到办公过程中，节省人工重复劳动，提高工作效率的一种现代化工作方式。


在日常的工作当中，你接触最多的办公软件，想必就是 office 套装中的那些工具了：Excel、Word、PPT。


表格整理、统计总结、文字处理，也许大量重复繁琐的工作正在耗费你的青春，你希望使用工具，更好的驱使电脑完成重复的劳动。


这门课程就是为了解放自我而设计。流沙团队为你讲述通过 Python 语言，如何让办公变得更为快捷和高效。


借助 Python 世界丰富的包资源，除了可以便捷的处理 office 文档，对于其它办公领域的工作，比如文件整理、电子邮件处理、Web 信息爬取、自动化消息处理等等，都可以手到擒来。


老师以日常工作中的常见需求为基础，结合实际案例为你编写了本门课程。期待在学习之后，可以让你掌握事半功倍的办公技巧：

| 序号 | 章节 | 知识点 |
| --- | --- | --- |
| 1 | 天才老师防作弊 | 自动化工具的构建 |
| 2 | 寻找VIP | Excel 文件读取、读取工作表、读取单元格、工作表切片 |
| 3 | 自动合并周报 | Excel 文件写入、操作工作表、修改单元格 |
| 4 | 自动生成销售英雄榜 | Excel 中的字体、公式、行列宽度调整、合并及拆分、图表绘制等 |
| 5 | 文件整理自动化工具 | 文件及目录操作、压缩及解压 |
| 6 | 自动批量生成邀请函 | Word 文档读写 |
| 7 | 自动合成文档、添加水印的小能手 | PDF 批量生成、页面读取、合并、叠加、加密和解密 |
| 8 | 自动发送通知和检查回复的小秘书 | 电子邮件处理 |
| 9 | 自动抽取页面信息的工具 | 使用 requests 做网页下载、BeautifulSoup 进行信息提取 |
| 10 | 网页交互操作自动化工具 | selenium 的使用 |
| 11 | 站巨人之肩上天揽月 | 以 API 方式使用网络服务 |
| 12 | 自动识别图片中的表格 | 以 SDK 方式使用网络服务 |
| 13 | 自动发送微信消息 | 操作键盘和鼠标 |

## 1.1 学习环境
阅读此文章搭建：[https://www.aiyc.top/772.html](https://www.aiyc.top/772.html)


在代码执行错误时，如果遇到不会的问题，可以点加流沙团队微信，群友就可以看到你的代码帮你解答了。当然，流沙也支持付费答疑。


## 1.2 学习方法
Python 办公自动化是一门实用性非常强的课程。在这里，我们将 Python 视为一个实现自动化处理的工具，课程主要聚焦如何正确的使用这个工具来完成工作需求。


你不需要对 Python 实现某个功能的具体原理细节了解太多，只需要知道如何正确的使用，解决问题就可以。


在学习的过程中，坚持**三多**原则（多想哪些工作可以通过程序自动化解决、多查资料实现想法、根据实际需求多练习），一定能娴熟的掌握 Python 工具，让你在工作中如虎添翼。


## 1.3 知识结构

- 需求描述
- 试卷生成（提取 provinces 和 options、创建试卷、创建答案）
- 生成答案迥异（jiǒng yì）的试卷



# 2. 需求描述
小悦在日常的工作中，遇到过这样的需求：**考察学员或者公司新员工的技术能力。**

**出一份考题让被考察者完成是一个最常用的方法。**


在本文中，请你跟着老师一起，用 Python 自动化地生成一份简单的地理试卷。这份试卷由 34 道选择题组成，题目形式都类似如下：

1. 河北省的省会是哪里？

A. 北京
B. 郑州
C. 石家庄
D. 张家口


## 2.1 试卷生成
![image.png](https://cdn.nlark.com/yuque/0/2021/png/1359959/1635522129996-fcc14c85-ff0f-4c13-87f8-a1311d83ae3a.png#clientId=ud96205be-8b3f-4&from=paste&id=u7b458e42&margin=%5Bobject%20Object%5D&name=image.png&originHeight=607&originWidth=1032&originalType=binary&ratio=1&size=67829&status=done&style=none&taskId=uc7c761e0-530d-4156-a2c5-a796760b98f)
试卷生成的工具以一个省与省会名的对应字典作为输入：
```python
capitals = {'北京市': '北京', '天津市': '天津', '上海市': '上海', '重庆市': '重庆',
            '河北省': '石家庄', '山西省': '太原', '陕西省': '西安', '山东省': '济南',
            '河南省': '郑州', '辽宁省': '沈阳', '吉林省': '长春', '黑龙江省': '哈尔滨',
            '江苏省': '南京', '浙江省': '杭州', '安徽省': '合肥', '江西省': '南昌',
            '福建省': '福州', '湖北省': '武汉', '湖南省': '长沙', '四川省': '成都',
            '贵州省': '贵阳', '云南省': '昆明', '广东省': '广州', '海南省': '海口',
            '甘肃省': '兰州', '青海省': '西宁', '台湾省': '台北', '内蒙古自治区': '呼和浩特',
            '新疆维吾尔自治区': '乌鲁木齐', '西藏自治区': '拉萨', '广西壮族自治区': '南宁',
            '宁夏回族自治区': '银川', '香港特别行政区': '香港', '澳门特别行政区': '澳门'}
```
我们要完成的这个工具需要做三件事情：

1. 抽取出 capitals 中的省名（key），组成一个列表 provinces。
1. 为每个 provinces 中的元素生成对应的题目选项，放置到列表 options 中。选项由城市名组成，其中有一个选项是正确答案，另外三个从其它城市中随机抽取。
1. 根据第1、2 步生成的 provinces 和 options，生成试卷以及试卷结果并保存到文件。



**也许只用语言描述有些抽象，我们用一张表来展视要构建的 provinces 和 options。**

| 元素索引 | provinces | options |
| --- | --- | --- |
| 0 | 北京市 | [拉萨,北京,海口,西宁] |
| … | … | … |
| n | 河北省 | [石家庄,银川, 贵阳, 哈尔滨] |
| … | … | … |

- provinces 是一个一维列表，每个元素是一个省的名字
- options 是一个二维列表，列表中的每个元素也是列表，由四个城市名组成，其中有一个城市是 provinces 中对应省的省会。



这样的两个列表一旦构建出来，生成试卷就会变得很简单，只需要从 0 到 33 遍历两个列表中的每个元素，分别取出省份名字以及城市选项名字，省份名字用在题面上，而城市选项用在选项上，就能正确输出结果了。

![c43ea65545f7973c743fe8fea45e4296.gif](https://gitee.com/huangjiabaoaiyc/image/raw/master/202110300050558.gif)

我们按照这个思路，分两步构建试卷。




## 2.2 提取 provinces 和 options
capitals 这个字典中，所有元素的 key 就是我们想要的省份名字，我们可以将它们提取出来，放到列表provinces 中。

::: details 想想怎么写，先自己写一下，然后点开看看，我提供的代码！
```python
capitals = {'北京市': '北京', '天津市': '天津', '上海市': '上海', '重庆市': '重庆',
            '河北省': '石家庄', '山西省': '太原', '陕西省': '西安', '山东省': '济南',
            '河南省': '郑州', '辽宁省': '沈阳', '吉林省': '长春', '黑龙江省': '哈尔滨',
            '江苏省': '南京', '浙江省': '杭州', '安徽省': '合肥', '江西省': '南昌',
            '福建省': '福州', '湖北省': '武汉', '湖南省': '长沙', '四川省': '成都',
            '贵州省': '贵阳', '云南省': '昆明', '广东省': '广州', '海南省': '海口',
            '甘肃省': '兰州', '青海省': '西宁', '台湾省': '台北', '内蒙古自治区': '呼和浩特',
            '新疆维吾尔自治区': '乌鲁木齐', '西藏自治区': '拉萨', '广西壮族自治区': '南宁',
            '宁夏回族自治区': '银川', '香港特别行政区': '香港', '澳门特别行政区': '澳门'}

# 提取 capitals 变量中所有元素的 key 值，组成新的列表变量 provinces
provinces = list(capitals.keys())
```
:::


> 流沙团队推出辅导班啦，包括「Python 语言辅导班、C++ 辅导班、java 辅导班、算法/数据结构辅导班、少儿编程、pygame 游戏开发」，全部都是一对一教学：一对一辅导 + 一对一答疑 + 布置作业 + 项目实践等。当然，还有线下线上摄影课程、Photoshop、Premiere 一对一教学、QQ、微信在线，随时响应！
